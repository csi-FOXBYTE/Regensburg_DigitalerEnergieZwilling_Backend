@startuml
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

title Digitaler Energie Zwilling (DEZ) - C4 Context Diagram

Person(citizen, "Citizen (owners/landlords)", "Uses the public 3D client")
Person(admin, "City Administration / Staff", "Configures content and reviews inputs")

System_Boundary(civitas, "CIVITAS/CORE Platform") {
  System(det, "Digitaler Energie Zwilling (DEZ)", "Web-based 3D application for energy potentials and simulations")
  System(idp, "Keycloak (CIVITAS/CORE)", "OIDC identity provider")
}

System_Ext(geo, "City Geo Services", "WMS and WMTS basemaps")
System_Ext(citygml, "CityGML LOD2 Source", "Input dataset")
System_Ext(potentials, "Solar (3D Tiles) and Geothermal Sources", "Solar 3D tiles + geothermal WMS/raster data")

Rel(citizen, det, "uses", "HTTPS")
Rel(admin, det, "uses", "HTTPS")
Rel(det, idp, "authenticates admins", "OIDC")
Rel(det, geo, "loads basemaps", "WMS/WMTS")
Rel(citygml, det, "provides building data (offline)")
Rel(potentials, det, "provides potentials (offline)")

@enduml
